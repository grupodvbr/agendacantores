<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Agenda de Músicos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      margin:0;
      font-family: 'Poppins', sans-serif;
      background:url('https://cdn.venngage.com/template/thumbnail/small/16d941ee-2e8e-49ac-889c-208297e1daad.webp') no-repeat center center/cover;
      color:#fff;
    }
    .overlay {
      background:rgba(10,0,30,0.75);
      min-height:100vh;
      padding:30px 20px;
      display:flex;
      flex-direction:column;
      align-items:center;
    }
    .titulo {
      text-align:center;
      margin-bottom:40px;
    }
    .titulo h1 {
      font-size:38px;
      font-weight:900;
      color:#ffd700;
      margin:0;
    }
    .titulo h2 {
      font-size:22px;
      font-weight:600;
      margin:5px 0 0;
      font-style:italic;
    }
    .lista {
      max-width:500px;
      width:100%;
    }
    .evento {
      display:flex;
      align-items:center;
      margin:18px 0;
    }
    .data {
      width:70px;
      text-align:center;
      font-weight:bold;
      font-size:22px;
      color:#fff;
    }
    .data span {
      display:block;
      font-size:14px;
      color:#ffd700;
    }
    .detalhes {
      border-left:3px solid #ffd700;
      padding-left:15px;
      margin-left:10px;
    }
    .detalhes h3 {
      margin:0;
      font-size:18px;
      font-weight:700;
    }
    .detalhes p {
      margin:2px 0;
      font-size:14px;
      color:#ddd;
    }
    /* Modal login */
    #loginModal {
      position:fixed; inset:0;
      background:rgba(0,0,0,.8);
      display:flex; align-items:center; justify-content:center;
      z-index:1000;
    }
    #loginBox {
      background:#fff; color:#000; padding:20px;
      border-radius:12px; width:320px;
    }
    #loginBox h2 { margin-top:0 }
    #loginBox label { display:block; margin-top:10px; }
    #loginBox input { width:100%; padding:8px; margin-top:4px;
      border:1px solid #ccc; border-radius:6px; }
    #loginMsg { color:red; margin-top:8px; font-size:14px; }
    button {
      padding:10px 20px; border:none; border-radius:8px;
      background:#ffd700; font-weight:bold; cursor:pointer;
      margin-top:15px;
    }
  </style>
</head>
<body>
  <div class="overlay">
    <div class="titulo">
      <h1>Músicos da Semana</h1>
      <h2 id="empresaNome"></h2>
    </div>
    <div class="lista" id="agenda"></div>
  </div>

  <!-- Login -->
  <div id="loginModal">
    <div id="loginBox">
      <h2>Login Empresa</h2>
      <label>Senha</label>
      <input type="password" id="senha">
      <button onclick="login()">Entrar</button>
      <p id="loginMsg"></p>
    </div>
  </div>

<script>
// URL do Apps Script que retorna os eventos filtrados por empresa
const API_URL = "https://script.google.com/macros/s/AKfycbzdkG1SxDulc0UDbf4PYwBvMQoJI1sDRQZ33VnJOLCS1pU_autY_CPULkm2usC9vfvW/exec"; 
let empresa = null;

// Senhas fixas no front
const SENHAS = {
  "1234": "Mercatto Delícia",
  "5678": "Villa Gourmet",
  "9999": "Delícia Gourmet"
};

// Checa se já está logado
function verificarLogin(){
  const e = localStorage.getItem("empresa");
  if(e){
    empresa = e;
    document.getElementById("loginModal").style.display="none";
    document.getElementById("empresaNome").textContent = empresa;
    carregarAgenda();
  }
}

// Faz login com senha fixa
function login(){
  const senha = document.getElementById("senha").value;
  if(SENHAS[senha]){
    empresa = SENHAS[senha];
    localStorage.setItem("empresa", empresa);
    document.getElementById("empresaNome").textContent = empresa;
    document.getElementById("loginModal").style.display="none";
    carregarAgenda();
  }else{
    document.getElementById("loginMsg").textContent = "Senha incorreta!";
  }
}

// Carrega agenda da empresa logada
async function carregarAgenda(){
  const lista = document.getElementById("agenda");
  lista.innerHTML="<p>Carregando...</p>";
  const res = await fetch(API_URL+"?empresa="+encodeURIComponent(empresa));
  const eventos = await res.json();
  lista.innerHTML="";
  eventos.forEach(ev=>{
    const d = new Date(ev.data);
    const dia = d.getDate().toString().padStart(2,"0");
    const mes = d.toLocaleString("pt-BR",{month:"short"});
    lista.innerHTML += `
      <div class="evento">
        <div class="data">${dia}<span>${mes.toUpperCase()}</span></div>
        <div class="detalhes">
          <h3>${ev.cantor}</h3>
          <p>${ev.hora} - R$ ${ev.valor}</p>
        </div>
      </div>`;
  });
}

verificarLogin();
</script>
</body>
</html>
